(()=>{var t,i,e={487:(t,i,e)=>{"use strict";var o=function(){};const s=function(){function t(t,i,e){this._img=new Image,this._img.onload=this._imageLoaded.bind(this),this._loadedCallback=e||o,this._img.src=t,this._loaded=!1}return t.prototype._imageLoaded=function(){this._loaded=!0,this._loadedCallback(this)},t.prototype._imageFailed=function(){throw"Image failed to load!"},t.prototype.getTexture=function(){return this._img},t}(),a=function(){function t(t){this._el=t,this._ctx=this._el.getContext("2d")}return t.prototype.beginRender=function(){this._drawStack=[]},t.prototype.endRender=function(){this._drawStack.sort((function(t,i){return t[0]<i[0]?-1:1}));for(var t=0,i=this._drawStack.length;t<i;t++)this._drawStack[t].shift(),this._ctx.drawImage.apply(this._ctx,this._drawStack[t])},t.prototype.getContext=function(){return this._ctx},t.prototype.drawWithZ=function(t,i,e,o,a,n,r,l){if(!(t instanceof s))throw"Invalid texture";this._drawStack.push([o,t.getTexture(),r,l,a,n,i,e,a,n])},t.prototype.draw=function(t,i,e,o,s,a,n){this.drawWithZ(t,i,e,0,o,s,a,n)},t.prototype.clear=function(){this._ctx.clearRect(0,0,this._el.width,this._el.height)},t.prototype.getWidth=function(){return this._el.width},t.prototype.getHeight=function(){return this._el.height},t}(),n=function(){function t(t,i,e){this._img=new s(t,i,this._imageLoaded.bind(this)),this._drawable=!1,this._canvas=e,this._canvasWidth=this._canvas.getWidth(),this._canvasHeight=this._canvas.getHeight(),this._currentAnimation,this._animations={},this._frame=0,this._frameCounter=0,this.x=0,this.y=0,this.z=0}return t.loadSheet=function(i,e,o){var s=new t(i.imagePath,e,o);return Object.keys(i.animations).forEach((function(t){var e=i.animations[t];e.forEach((function(t){t.width=t.width||i.defaultWidth,t.height=t.height||i.defaultHeight,t.duration=t.duration||i.defaultDuration})),s.registerAnimation(t,e)})),i.defaultAnimation&&s.setAnimation(i.defaultAnimation),s},t.prototype._imageLoaded=function(){this._drawable=!0},t.prototype.registerAnimation=function(t,i){this._animations[t]=Array.isArray(i)?i:[i]},t.prototype.move=function(t,i){this.x=t,this.y=i},t.prototype.setAnimation=function(t){t!==this._currentAnimation&&(this._currentAnimation=t,this._frame=0,this._frameCounter=this._animations[t][0].duration||-1)},t.prototype.setZOrder=function(t){this.z=t},t.prototype.draw=function(t){if(void 0===t&&(t=!1),this._drawable){var i=this._currentAnimation,e=this._animations[i][this._frame];if(this.x+e.width<=0||this.y+e.height<=0||this.x>=this._canvasWidth||this.y>=this._canvasHeight)return;this._canvas.drawWithZ(this._img,this.x,this.y,this.z,e.width,e.height,e.x,e.y),t||(this._frameCounter--,0===this._frameCounter&&(this._frame++,this._frame>=this._animations[i].length&&(this._frame=0),this._frameCounter=this._animations[i][this._frame].duration||0))}},t}(),r=JSON.parse('{"imagePath":"images/link.png","defaultDuration":5,"defaultWidth":16,"defaultHeight":16,"defaultAnimation":"down","animations":{"down":[{"x":0,"y":192}],"up":[{"x":60,"y":192}],"left":[{"x":30,"y":192}],"right":[{"x":90,"y":192}]}}');var l=e.t(r,2),h={left:{x:-2,y:0},right:{x:2,y:0},up:{x:0,y:-2},down:{x:0,y:2}};const f=function(){function t(t){this._game=t,this._sword=n.loadSheet(l,t.getWindow(),t.getCanvas())}return t.prototype.swing=function(t,i,e){this._counter=0,this._animating=!0,this._x=t,this._y=i,this._velocity=h[e],this._sword.setAnimation(e)},t.prototype.update=function(){this._animating&&(this._x+=this._velocity.x,this._y+=this._velocity.y,this._sword.move(this._x,this._y),this._counter++,6===this._counter?(this._x=-this._x,this._y=-this._y):this._counter>=12&&(this._animating=!1))},t.prototype.draw=function(){this._animating&&this._sword.draw()},t.prototype.isSwinging=function(){return this._animating},t}(),p=JSON.parse('{"imagePath":"images/link.png","defaultDuration":5,"defaultWidth":16,"defaultHeight":16,"defaultAnimation":"down","animations":{"down":[{"x":0,"y":0},{"x":0,"y":30}],"up":[{"x":60,"y":0},{"x":60,"y":30}],"left":[{"x":30,"y":0},{"x":30,"y":30}],"right":[{"x":90,"y":0},{"x":90,"y":30}],"sword-down":[{"x":0,"y":60}],"sword-up":[{"x":60,"y":60}],"sword-left":[{"x":30,"y":60}],"sword-right":[{"x":90,"y":60}]}}');var _,d=e.t(p,2);!function(t){t.Left="left",t.Right="right",t.Down="down",t.Up="up"}(_||(_={}));const u=function(){function t(t){this._game=t,this._sprite=n.loadSheet(d,t.getWindow(),t.getCanvas()),this._sprite.setZOrder(1),this._sword=new f(t),this._x=0,this._y=0,this._directionCounter=0,this._direction=_.Down,this._animating=!1,this._swinging=!1}return t.prototype.update=function(t){var i=this._game.getGameObject("dungeon"),e=Object.keys(t).filter((function(i){return t[i]})).length>0;this._animating=e,i.isTransitioning()?this._updateForDungeonTransition(i):this._swinging?(this._sword.update(),this._swinging=this._sword.isSwinging(),this._swinging||this._sprite.setAnimation(this._direction)):t.action&&!this._swinging?(this._sprite.setAnimation("sword-"+this._direction),this._sword.swing(this._x,this._y,this._direction),this._swinging=!0):this._directionCounter<=0&&e&&!this._swinging?this._handleKeyPress(t,i):this._directionCounter--},t.prototype.draw=function(){this._swinging&&this._sword.draw(),this._sprite.draw(!this._animating)},t.prototype._handleKeyPress=function(t,i){var e=this._x,o=this._y;t.down?(o+=1,this._direction=_.Down):t.up?(o-=1,this._direction=_.Up):t.left?(e-=1,this._direction=_.Left):t.right&&(e+=1,this._direction=_.Right),this._sprite.setAnimation(this._direction),i.canPass(e,o+p.defaultHeight/2,p.defaultWidth,p.defaultHeight/2)&&(this._x=e,this._y=o,this._sprite.move(this._x,this._y))},t.prototype._updateForDungeonTransition=function(t){var i=t.getTransitionSpeeds(),e=t.getCurrentRoomWidth();this._x+=i.x,this._y+=i.y,this._x=this._x<0?0:this._x,this._y=this._y<0?0:this._y,this._x=this._x+p.defaultWidth>e?e-p.defaultWidth:this._x,this._sprite.move(this._x,this._y)},t}();var c;!function(t){t.East="east",t.South="south",t.West="west",t.North="north"}(c||(c={}));const b=function(){function t(t,i,e,o,s){this._data=t,this._exits=i,this._tileset=s,this._tileWidth=e,this._tileHeight=o}return t.prototype.draw=function(t,i){var e,o,s,a=this._tileset;t=t||0,i=i||0;for(var n=0,r=this._data.length;n<r;n++){s=this._data[n],o=n*this._tileHeight;for(var l=0,h=s.length;l<h;l++)e=l*this._tileWidth,a.move(e+t,o+i),a.setAnimation(s[l].tile),a.draw()}},t.prototype.canPass=function(t,i,e,o){for(var s,a,n,r=i,l=this._data;r<i+o;r++)for(s=t;s<t+e;s++){if(a=Math.floor(s/this._tileWidth),!((n=Math.floor(r/this._tileHeight))>=0&&l.length>n&&a>=0&&l[n].length>a))return n<0?this._edgeHit=c.North:n>=l.length?this._edgeHit=c.South:this._edgeHit=a<0?c.West:c.East,!1;if(!l[n][a].passable)return!1}return this._edgeHit=!1,!0},t.prototype.roomTransition=function(){return this._edgeHit},t.prototype.getRoomWidthInPixels=function(){return this._data[0].length*this._tileWidth},t.prototype.getRoomHeightInPixels=function(){return this._data.length*this._tileHeight},t.prototype.getExitForDirection=function(t){return!1!==t&&!0!==t&&!!this._exits[t]&&this._exits[t]},t.prototype.reset=function(){delete this._edgeHit},t}();var g={room1:e(149),room2:e(30)},m={east:{x:-1,y:0},west:{x:1,y:0},north:{x:0,y:1},south:{x:0,y:-1}};const y=function(){function t(t,i){this._data=t,this._loadTiles(i.getWindow(),i.getCanvas()),this._loadRooms()}return t.prototype._loadRooms=function(){var t=this,i={},e=this._tileset,o=this._data.tileWidth,s=this._data.tileHeight;Object.keys(t._data.rooms).forEach((function(a){i[a]=new b(g[a],t._data.rooms[a].exits,o,s,e)})),this._currentRoom=i[t._data.startRoom],this._rooms=i},t.prototype._loadTiles=function(t,i){var e=this._data,o=this._tileset=new n("./images/"+e.tileset,t,i);Object.keys(e.tiles).forEach((function(t){var i=e.tiles[t];o.registerAnimation(t,[{width:e.tileWidth,height:e.tileHeight,x:i.x*e.tileWidth,y:i.y*e.tileHeight}])}))},t.prototype.update=function(){if(this._transitioning)this._transitionX+=this._transitionSpeedX,this._transitionY+=this._transitionSpeedY,this._transitionCounter++,this._transitionCounter>=60&&(this._currentRoom.reset(),this._nextRoom.reset(),this._currentRoom=this._nextRoom,this._nextRoom=null,this._transitioning=!1,this._transitionCounter=this._transitionX=this._transitionY=0);else{var t=this._currentRoom.roomTransition();if(!1!==t&&!0!==t){var i=this._currentRoom.getExitForDirection(t);if(i){var e=m[t],o=this._currentRoom.getRoomWidthInPixels(),s=this._currentRoom.getRoomHeightInPixels();this._transitioning=!0,this._nextRoom=this._rooms[i],this._transitionX=this._transitionY=this._transitionCounter=0,this._transitionSpeedX=o/60*e.x,this._transitionSpeedY=s/60*e.y,this._nextRoomOffsetX=(e.x>0?this._nextRoom.getRoomWidthInPixels():o)*e.x*-1,this._nextRoomOffsetY=(e.y>0?this._nextRoom.getRoomHeightInPixels():s)*e.y*-1}}}},t.prototype.canPass=function(t,i,e,o){return this._currentRoom.canPass(t,i,e,o)},t.prototype.draw=function(){this._currentRoom.draw(this._transitionX,this._transitionY),this._nextRoom&&this._nextRoom.draw(this._transitionX+this._nextRoomOffsetX,this._transitionY+this._nextRoomOffsetY)},t.prototype.isTransitioning=function(){return this._transitioning},t.prototype.getTransitionSpeeds=function(){return{x:this._transitionSpeedX,y:this._transitionSpeedY}},t.prototype.getCurrentRoomWidth=function(){return this._currentRoom.getRoomWidthInPixels()},t}();var x=Math.floor(1e3/60),w={37:"left",39:"right",38:"up",40:"down",65:"action"},v={left:!1,right:!1,up:!1,down:!1,action:!1},R=function(){function t(t,i){this._win=t,this._doc=t.document,this._canvasEl=i,this._ctx=i.getContext("2d"),this._ctx.imageSmoothingEnabled=!1,this._buffer=this._doc.createElement("canvas"),this._buffer.width=256,this._buffer.height=224,this._canvas=new a(this._buffer),this._gameObjects={player:new u(this),dungeon:new y(e(141),this)},this._doc.addEventListener("keydown",this._handleKeydown.bind(this)),this._doc.addEventListener("keyup",this._handleKeyup.bind(this)),setInterval(this.loop.bind(this),x)}return t.prototype.loop=function(){this._canvas.clear(),this._canvas.beginRender(),this._gameObjects.dungeon.update(),this._gameObjects.player.update(v),this._gameObjects.dungeon.draw(),this._gameObjects.player.draw(),this._canvas.endRender(),this._ctx.drawImage(this._buffer,0,0,256,224,0,0,512,448)},t.prototype.getWindow=function(){return this._win},t.prototype.getCanvas=function(){return this._canvas},t.prototype.getGameObject=function(t){return this._gameObjects[t]},t.prototype._handleKeydown=function(t){w.hasOwnProperty(t.keyCode)&&(v[w[t.keyCode]]=!0,t.preventDefault())},t.prototype._handleKeyup=function(t){w.hasOwnProperty(t.keyCode)&&(v[w[t.keyCode]]=!1,t.preventDefault())},t}();window.Game=R},141:t=>{t.exports={tileset:"dungeon-sprites.png",tileWidth:16,tileHeight:16,startRoom:"room1",rooms:{room1:{dataset:"room1",exits:{east:"room2"}},room2:{dataset:"room2",exits:{west:"room1"}}},tiles:{floor:{x:0,y:0},block:{x:1,y:0}}}},149:t=>{t.exports=[[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"block",passable:!1},{tile:"block",passable:!1},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"block",passable:!1},{tile:"block",passable:!1},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}]]},30:t=>{t.exports=[[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"block",passable:!1},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"block",passable:!1},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"block",passable:!1},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"block",passable:!1},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}],[{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0},{tile:"floor",passable:!0}]]}},o={};function s(t){var i=o[t];if(void 0!==i)return i.exports;var a=o[t]={exports:{}};return e[t](a,a.exports,s),a.exports}i=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var a=Object.create(null);s.r(a);var n={};t=t||[null,i({}),i([]),i(i)];for(var r=2&o&&e;"object"==typeof r&&!~t.indexOf(r);r=i(r))Object.getOwnPropertyNames(r).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,s.d(a,n),a},s.d=(t,i)=>{for(var e in i)s.o(i,e)&&!s.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},s.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s(487)})();